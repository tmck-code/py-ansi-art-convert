FONT_DATA = {
    'IBM VGA': {
        'name': 'IBM VGA',
        'font_size': '9x16',
        'resolution': '720x400',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '20:27 (1:1.35)',
        'vertical_stretch': '35%',
        'description': 'Standard hardware font on VGA cards for 80x25 text mode (code page 437)',
    },
    'IBM VGA (8px)': {
        'name': 'IBM VGA (8px)',
        'font_size': '8x16',
        'resolution': '640x400',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '6:5 (1:1.2)',
        'vertical_stretch': '20%',
        'description': 'Modified stats when using an 8 pixel wide version of \'IBM VGA\' or code page variant.',
    },
    'IBM VGA50': {
        'name': 'IBM VGA50',
        'font_size': '9x8',
        'resolution': '720x400',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '20:27 (1:1.35)',
        'vertical_stretch': '35%',
        'description': 'Standard hardware font on VGA cards for condensed 80x50 text mode (code page 437)',
    },
    'IBM VGA50 (8px)': {
        'name': 'IBM VGA50 (8px)',
        'font_size': '8x8',
        'resolution': '640x400',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:6 (1:1.2)',
        'vertical_stretch': '20%',
        'description': 'Modified stats when using an 8 pixel wide version of \'IBM VGA50\' or code page variant.',
    },
    'IBM VGA25G': {
        'name': 'IBM VGA25G',
        'font_size': '8x19',
        'resolution': '640x480',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '1:1',
        'vertical_stretch': '0%',
        'description': 'Custom font for emulating 80x25 in VGA graphics mode 12 (640x480 16 color) (code page 437).',
    },
    'IBM EGA': {
        'name': 'IBM EGA',
        'font_size': '8x14',
        'resolution': '640x350',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '35:48 (1:1.3714)',
        'vertical_stretch': '37.14%',
        'description': 'Standard hardware font on EGA cards for 80x25 text mode (code page 437)',
    },
    'IBM EGA43': {
        'name': 'IBM EGA43',
        'font_size': '8x8',
        'resolution': '640x350',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '35:48 (1:1.3714)',
        'vertical_stretch': '37.14%',
        'description': 'Standard hardware font on EGA cards for condensed 80x43 text mode (code page 437)',
    },
    'IBM VGA ###': {
        'name': 'IBM VGA ###',
        'font_size': '9x16',
        'resolution': '720x400',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '20:27 (1:1.35)',
        'vertical_stretch': '35%',
        'description': 'Software installed code page font for VGA 80x25 text mode',
    },
    'IBM VGA50 ###': {
        'name': 'IBM VGA50 ###',
        'font_size': '9x8',
        'resolution': '720x400',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '20:27 (1:1.35)',
        'vertical_stretch': '35%',
        'description': 'Software installed code page font for VGA condensed 80x50 text mode',
    },
    'IBM VGA25G ###': {
        'name': 'IBM VGA25G ###',
        'font_size': '8x19',
        'resolution': '640x480',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '1:1',
        'vertical_stretch': '0%',
        'description': 'Custom font for emulating 80x25 in VGA graphics mode 12 (640x480 16 color).',
    },
    'IBM EGA ###': {
        'name': 'IBM EGA ###',
        'font_size': '8x14',
        'resolution': '640x350',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '35:48 (1:1.3714)',
        'vertical_stretch': '37.14%',
        'description': 'Software installed code page font for EGA 80x25 text mode',
    },
    'IBM EGA43 ###': {
        'name': 'IBM EGA43 ###',
        'font_size': '8x8',
        'resolution': '640x350',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '35:48 (1:1.3714)',
        'vertical_stretch': '37.14%',
        'description': 'Software installed code page font for EGA condensed 80x43 text mode',
    },
    'Amiga Topaz 1': {
        'name': 'Amiga Topaz 1',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Original Amiga Topaz Kickstart 1.x font. (A500, A1000, A2000)',
    },
    'Amiga Topaz 1+': {
        'name': 'Amiga Topaz 1+',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Modified Amiga Topaz Kickstart 1.x font. (A500, A1000, A2000)',
    },
    'Amiga Topaz 2': {
        'name': 'Amiga Topaz 2',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Original Amiga Topaz Kickstart 2.x font (A600, A1200, A4000)',
    },
    'Amiga Topaz 2+': {
        'name': 'Amiga Topaz 2+',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Modified Amiga Topaz Kickstart 2.x font (A600, A1200, A4000)',
    },
    'Amiga P0T-NOoDLE': {
        'name': 'Amiga P0T-NOoDLE',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Original P0T-NOoDLE font.',
    },
    'Amiga MicroKnight': {
        'name': 'Amiga MicroKnight',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Original MicroKnight font.',
    },
    'Amiga MicroKnight+': {
        'name': 'Amiga MicroKnight+',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Modified MicroKnight font.',
    },
    'Amiga mOsOul': {
        'name': 'Amiga mOsOul',
        'font_size': '8x8',
        'resolution': '640x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:12 (1:2.4)',
        'vertical_stretch': '140%',
        'description': 'Original mOsOul font.',
    },
    'C64 PETSCII unshifted': {
        'name': 'C64 PETSCII unshifted',
        'font_size': '8x8',
        'resolution': '320x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:6 (1:1.2)',
        'vertical_stretch': '20%',
        'description': 'Original Commodore PETSCII font (PET, VIC-20, C64, CBM-II, Plus/4, C16, C116 and C128) in the unshifted mode. Unshifted mode (graphics) only has uppercase letters and additional graphic characters. This is the normal boot font.',
    },
    'C64 PETSCII shifted': {
        'name': 'C64 PETSCII shifted',
        'font_size': '8x8',
        'resolution': '320x200',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '5:6 (1:1.2)',
        'vertical_stretch': '20%',
        'description': 'Original PETSCII font in shifted mode. Shifted mode (text) has both uppercase and lowercase letters. This mode is actuated by pressing Shift+Commodore key.',
    },
    'Atari ATASCII': {
        'name': 'Atari ATASCII',
        'font_size': '8x8',
        'resolution': '320x192',
        'aspect_ratio': '4:3',
        'pixel_aspect_ratio': '4:5 (1:1.25)',
        'vertical_stretch': '25%',
        'description': 'Original ATASCII font (Atari 400, 800, XL, XE)',
    },
}

FONT_OFFSETS = {
    'Amiga Topaz 1': 0xE000,
    'Amiga Topaz 1+': 0xE100,
    'Amiga Topaz 2': 0xE200,
    'Amiga Topaz 2+': 0xE300,
    'Amiga MicroKnight': 0xE400,
    'Amiga MicroKnight+': 0xE500,
    'Amiga mOsOul': 0xE600,
    'Amiga P0T-NOoDLE': 0xE700,
    # TODO: implement all IBM fonts
    'IBM VGA': 0xE800,
    'IBM VGA (8px)': 0xE800,
    'IBM VGA50': 0xE800,
    'IBM VGA50 (8px)': 0xE800,
    'IBM VGA25G': 0xE800,
    'IBM EGA': 0xE800,
    'IBM EGA43': 0xE800,
    'IBM VGA ###': 0xE800,
    'IBM VGA50 ###': 0xE800,
    'IBM VGA25G ###': 0xE800,
    'IBM EGA ###': 0xE800,
    'IBM EGA43 ###': 0xE800,
    # TODO: support these fonts
    # 'C64 PETSCII unshifted'
    # 'C64 PETSCII shifted'
    # 'Atari ATASCII'
}

FONT_ALIASES = {
    'topaz 1': 'Amiga Topaz 1',
    'topaz 1+': 'Amiga Topaz 1+',
    'topaz 2': 'Amiga Topaz 2',
    'topaz 2+': 'Amiga Topaz 2+',
    'microknight': 'Amiga MicroKnight',
    'microknight+': 'Amiga MicroKnight+',
    'mosoul': 'Amiga mOsOul',
    'potnoodle': 'Amiga P0T-NOoDLE',
    'ibm vga': 'IBM VGA',
}

FILE_DATA_TYPES = {
    (1, 0): {
        'name': 'ASCII',
        'description': 'Plain ASCII text file with no formatting codes or color codes.',
        'tinfo1': 'Character width',
        'tinfo2': 'Number of lines',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': 'ANSiFlags',
        'tinfos': 'FontName',
    },
    (1, 1): {
        'name': 'ANSi',
        'description': 'A file with ANSi coloring codes and cursor positioning.',
        'tinfo1': 'Character width',
        'tinfo2': 'Number of lines',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': 'ANSiFlags',
        'tinfos': 'FontName',
    },
    (1, 2): {
        'name': 'ANSiMation',
        'description': 'Like an ANSi file, but it relies on a fixed screen size.',
        'tinfo1': 'Character width',
        'tinfo2': 'Character screen height [5]',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': 'ANSiFlags',
        'tinfos': 'FontName',
    },
    (1, 3): {
        'name': 'RIP script',
        'description': 'Remote Imaging Protocol graphics.',
        'tinfo1': 'Pixel width (640)',
        'tinfo2': 'Pixel height (350)',
        'tinfo3': 'Number of colors (16)',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
    (1, 4): {
        'name': 'PCBoard',
        'description': 'A file with PCBoard color codes and macros, and ANSi codes.',
        'tinfo1': 'Character width',
        'tinfo2': 'Number of lines',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
    (1, 5): {
        'name': 'Avatar',
        'description': 'A file with Avatar color codes, and ANSi codes.',
        'tinfo1': 'Character width',
        'tinfo2': 'Number of lines',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
    (1, 6): {
        'name': 'HTML',
        'description': 'HyperText Markup Language',
        'tinfo1': '0',
        'tinfo2': '0',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
    (1, 7): {
        'name': 'Source',
        'description': 'Source code for some programming language. The file extension should determine the programming language.',
        'tinfo1': '0',
        'tinfo2': '0',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
    (1, 8): {
        'name': 'TundraDraw',
        'description': 'A TundraDraw file. Like ANSI, but with a custom palette.',
        'tinfo1': 'Character width',
        'tinfo2': 'Number of lines',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
    (6, 0): {
        'name': '-',
        'description': 'eXtended Bin',
        'tinfo1': 'Character width',
        'tinfo2': 'Number of lines',
        'tinfo3': '0',
        'tinfo4': '0',
        'flags': '0',
        'tinfos': '0',
    },
}


# Dictionary mapping Unicode character to CP437 byte value
# Only includes mappings where Unicode codepoint != CP437 value
UNICODE_TO_CP437 = {
    0xC7: 0x80,  # LATIN CAPITAL LETTER C WITH CEDILLA
    0xFC: 0x81,  # LATIN SMALL LETTER U WITH DIAERESIS
    0xE9: 0x82,  # LATIN SMALL LETTER E WITH ACUTE
    0xE2: 0x83,  # LATIN SMALL LETTER A WITH CIRCUMFLEX
    0xE4: 0x84,  # LATIN SMALL LETTER A WITH DIAERESIS
    0xE0: 0x85,  # LATIN SMALL LETTER A WITH GRAVE
    0xE5: 0x86,  # LATIN SMALL LETTER A WITH RING ABOVE
    0xE7: 0x87,  # LATIN SMALL LETTER C WITH CEDILLA
    0xEA: 0x88,  # LATIN SMALL LETTER E WITH CIRCUMFLEX
    0xEB: 0x89,  # LATIN SMALL LETTER E WITH DIAERESIS
    0xE8: 0x8A,  # LATIN SMALL LETTER E WITH GRAVE
    0xEF: 0x8B,  # LATIN SMALL LETTER I WITH DIAERESIS
    0xEE: 0x8C,  # LATIN SMALL LETTER I WITH CIRCUMFLEX
    0xEC: 0x8D,  # LATIN SMALL LETTER I WITH GRAVE
    0xC4: 0x8E,  # LATIN CAPITAL LETTER A WITH DIAERESIS
    0xC5: 0x8F,  # LATIN CAPITAL LETTER A WITH RING ABOVE
    0xC9: 0x90,  # LATIN CAPITAL LETTER E WITH ACUTE
    0xE6: 0x91,  # LATIN SMALL LIGATURE AE
    0xC6: 0x92,  # LATIN CAPITAL LIGATURE AE
    0xF4: 0x93,  # LATIN SMALL LETTER O WITH CIRCUMFLEX
    0xF6: 0x94,  # LATIN SMALL LETTER O WITH DIAERESIS
    0xF2: 0x95,  # LATIN SMALL LETTER O WITH GRAVE
    0xFB: 0x96,  # LATIN SMALL LETTER U WITH CIRCUMFLEX
    0xF9: 0x97,  # LATIN SMALL LETTER U WITH GRAVE
    0xFF: 0x98,  # LATIN SMALL LETTER Y WITH DIAERESIS
    0xD6: 0x99,  # LATIN CAPITAL LETTER O WITH DIAERESIS
    0xDC: 0x9A,  # LATIN CAPITAL LETTER U WITH DIAERESIS
    0xA2: 0x9B,  # CENT SIGN
    0xA3: 0x9C,  # POUND SIGN
    0xA5: 0x9D,  # YEN SIGN
    0x20A7: 0x9E,  # PESETA SIGN
    0x0192: 0x9F,  # LATIN SMALL LETTER F WITH HOOK
    0xE1: 0xA0,  # LATIN SMALL LETTER A WITH ACUTE
    0xED: 0xA1,  # LATIN SMALL LETTER I WITH ACUTE
    0xF3: 0xA2,  # LATIN SMALL LETTER O WITH ACUTE
    0xFA: 0xA3,  # LATIN SMALL LETTER U WITH ACUTE
    0xF1: 0xA4,  # LATIN SMALL LETTER N WITH TILDE
    0xD1: 0xA5,  # LATIN CAPITAL LETTER N WITH TILDE
    0xAA: 0xA6,  # FEMININE ORDINAL INDICATOR
    0xBA: 0xA7,  # MASCULINE ORDINAL INDICATOR
    0xBF: 0xA8,  # INVERTED QUESTION MARK
    0x2310: 0xA9,  # REVERSED NOT SIGN
    0xAC: 0xAA,  # NOT SIGN
    0xBD: 0xAB,  # VULGAR FRACTION ONE HALF
    0xBC: 0xAC,  # VULGAR FRACTION ONE QUARTER
    0xA1: 0xAD,  # INVERTED EXCLAMATION MARK
    0xAB: 0xAE,  # LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
    0xBB: 0xAF,  # RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
    0x2591: 0xB0,  # LIGHT SHADE
    0x2592: 0xB1,  # MEDIUM SHADE
    0x2593: 0xB2,  # DARK SHADE
    0x2502: 0xB3,  # BOX DRAWINGS LIGHT VERTICAL
    0x2524: 0xB4,  # BOX DRAWINGS LIGHT VERTICAL AND LEFT
    0x2561: 0xB5,  # BOX DRAWINGS VERTICAL SINGLE AND LEFT DOUBLE
    0x2562: 0xB6,  # BOX DRAWINGS VERTICAL DOUBLE AND LEFT SINGLE
    0x2556: 0xB7,  # BOX DRAWINGS DOWN DOUBLE AND LEFT SINGLE
    0x2555: 0xB8,  # BOX DRAWINGS DOWN SINGLE AND LEFT DOUBLE
    0x2563: 0xB9,  # BOX DRAWINGS DOUBLE VERTICAL AND LEFT
    0x2551: 0xBA,  # BOX DRAWINGS DOUBLE VERTICAL
    0x2557: 0xBB,  # BOX DRAWINGS DOUBLE DOWN AND LEFT
    0x255D: 0xBC,  # BOX DRAWINGS DOUBLE UP AND LEFT
    0x255C: 0xBD,  # BOX DRAWINGS UP DOUBLE AND LEFT SINGLE
    0x255B: 0xBE,  # BOX DRAWINGS UP SINGLE AND LEFT DOUBLE
    0x2510: 0xBF,  # BOX DRAWINGS LIGHT DOWN AND LEFT
    0x2514: 0xC0,  # BOX DRAWINGS LIGHT UP AND RIGHT
    0x2534: 0xC1,  # BOX DRAWINGS LIGHT UP AND HORIZONTAL
    0x252C: 0xC2,  # BOX DRAWINGS LIGHT DOWN AND HORIZONTAL
    0x251C: 0xC3,  # BOX DRAWINGS LIGHT VERTICAL AND RIGHT
    0x2500: 0xC4,  # BOX DRAWINGS LIGHT HORIZONTAL
    0x253C: 0xC5,  # BOX DRAWINGS LIGHT VERTICAL AND HORIZONTAL
    0x255E: 0xC6,  # BOX DRAWINGS VERTICAL SINGLE AND RIGHT DOUBLE
    0x255F: 0xC7,  # BOX DRAWINGS VERTICAL DOUBLE AND RIGHT SINGLE
    0x255A: 0xC8,  # BOX DRAWINGS DOUBLE UP AND RIGHT
    0x2554: 0xC9,  # BOX DRAWINGS DOUBLE DOWN AND RIGHT
    0x2569: 0xCA,  # BOX DRAWINGS DOUBLE UP AND HORIZONTAL
    0x2566: 0xCB,  # BOX DRAWINGS DOUBLE DOWN AND HORIZONTAL
    0x2560: 0xCC,  # BOX DRAWINGS DOUBLE VERTICAL AND RIGHT
    0x2550: 0xCD,  # BOX DRAWINGS DOUBLE HORIZONTAL
    0x256C: 0xCE,  # BOX DRAWINGS DOUBLE VERTICAL AND HORIZONTAL
    0x2567: 0xCF,  # BOX DRAWINGS UP SINGLE AND HORIZONTAL DOUBLE
    0x2568: 0xD0,  # BOX DRAWINGS UP DOUBLE AND HORIZONTAL SINGLE
    0x2564: 0xD1,  # BOX DRAWINGS DOWN SINGLE AND HORIZONTAL DOUBLE
    0x2565: 0xD2,  # BOX DRAWINGS DOWN DOUBLE AND HORIZONTAL SINGLE
    0x2559: 0xD3,  # BOX DRAWINGS UP DOUBLE AND RIGHT SINGLE
    0x2558: 0xD4,  # BOX DRAWINGS UP SINGLE AND RIGHT DOUBLE
    0x2552: 0xD5,  # BOX DRAWINGS DOWN SINGLE AND RIGHT DOUBLE
    0x2553: 0xD6,  # BOX DRAWINGS DOWN DOUBLE AND RIGHT SINGLE
    0x256B: 0xD7,  # BOX DRAWINGS VERTICAL DOUBLE AND HORIZONTAL SINGLE
    0x256A: 0xD8,  # BOX DRAWINGS VERTICAL SINGLE AND HORIZONTAL DOUBLE
    0x2518: 0xD9,  # BOX DRAWINGS LIGHT UP AND LEFT
    0x250C: 0xDA,  # BOX DRAWINGS LIGHT DOWN AND RIGHT
    0x2588: 0xDB,  # FULL BLOCK
    0x2584: 0xDC,  # LOWER HALF BLOCK
    0x258C: 0xDD,  # LEFT HALF BLOCK
    0x2590: 0xDE,  # RIGHT HALF BLOCK
    0x2580: 0xDF,  # UPPER HALF BLOCK
    0x03B1: 0xE0,  # GREEK SMALL LETTER ALPHA
    0xDF: 0xE1,  # LATIN SMALL LETTER SHARP S
    0x0393: 0xE2,  # GREEK CAPITAL LETTER GAMMA
    0x03C0: 0xE3,  # GREEK SMALL LETTER PI
    0x03A3: 0xE4,  # GREEK CAPITAL LETTER SIGMA
    0x03C3: 0xE5,  # GREEK SMALL LETTER SIGMA
    0xB5: 0xE6,  # MICRO SIGN
    0x03C4: 0xE7,  # GREEK SMALL LETTER TAU
    0x03A6: 0xE8,  # GREEK CAPITAL LETTER PHI
    0x0398: 0xE9,  # GREEK CAPITAL LETTER THETA
    0x03A9: 0xEA,  # GREEK CAPITAL LETTER OMEGA
    0x03B4: 0xEB,  # GREEK SMALL LETTER DELTA
    0x221E: 0xEC,  # INFINITY
    0x03C6: 0xED,  # GREEK SMALL LETTER PHI
    0x03B5: 0xEE,  # GREEK SMALL LETTER EPSILON
    0x2229: 0xEF,  # INTERSECTION
    0x2261: 0xF0,  # IDENTICAL TO
    0xB1: 0xF1,  # PLUS-MINUS SIGN
    0x2265: 0xF2,  # GREATER-THAN OR EQUAL TO
    0x2264: 0xF3,  # LESS-THAN OR EQUAL TO
    0x2320: 0xF4,  # TOP HALF INTEGRAL
    0x2321: 0xF5,  # BOTTOM HALF INTEGRAL
    0xF7: 0xF6,  # DIVISION SIGN
    0x2248: 0xF7,  # ALMOST EQUAL TO
    0xB0: 0xF8,  # DEGREE SIGN
    0x2219: 0xF9,  # BULLET OPERATOR
    0xB7: 0xFA,  # MIDDLE DOT
    0x221A: 0xFB,  # SQUARE ROOT
    0x207F: 0xFC,  # SUPERSCRIPT LATIN SMALL LETTER N
    0xB2: 0xFD,  # SUPERSCRIPT TWO
    0x25A0: 0xFE,  # BLACK SQUARE
    0xA0: 0xFF,  # NO-BREAK SPACE
}
